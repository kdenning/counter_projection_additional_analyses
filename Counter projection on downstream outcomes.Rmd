---
title: "Counter projection on downstream outcomes"
author: "Kathryn Denning"
date: "6/18/2020"
output: 
  html_document:
    code_folding: "hide"
    toc: true
    toc_float: true
    dev: png
  pdf_document:
    dev: cairo_pdf
    latex_engine: xelatex
editor_options: 
  chunk_output_type: console
---
```{r set-up, include = FALSE}
#loading packages
library(foreign)
library(reshape2)
library(tidyverse)
library(dplyr)
library(car)
library(haven)
library(psych)
library(lmerTest)
library(sjPlot)
library(reshape2)
library(data.table)
library(emmeans)
library(effects)
library(Cairo)
library(tinytex)
library(rio)

#making it round to three decimal places
options(scipen = 999)
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)

knitr::opts_knit$set(dev.args = list(type = "cairo"))

trace(grDevices:::png, quote({
  if (missing(type) && missing(antialias)) {
    type <- "cairo-png"
    antialias <- "subpixel"
  }
}), print = FALSE)
```

```{r data import and cleaning initial study, include = FALSE}
#importing data with IP address and lat/long to look for MTurk bots
bot_check <- Import("ppt1_with lat long to check bots.csv") 

bot_check <- bot_check[-c(1,2),,drop = F] 

#importing the data that has been reviewed for completion of PT task
wide_data <- Import("ppt1_fulldata_ptcleanedonly.xlsx") 

#dropping the longer description of each question
wide_dropped1 <- wide_data[-c(1),,drop = F] 

#removing repeat IP addresses since those often indicate bots
#getting a dataset with only subid and IPAdress
ip <- bot_check %>% 
  select(subid, IPAddress)

#identifying the repeat IP addresses
repeat_ips <- ip$IPAddress[duplicated(ip$IPAddress)]

#getting the corresponding subids
bot_check %>% 
  select(subid, IPAddress, LocationLatitude, LocationLongitude) %>% 
  filter(IPAddress %in% c("24.241.223.182", "72.79.119.56", "108.230.124.237", "172.97.7.163", "67.236.228.7", "68.190.36.43"))

#removing the subids from the overall dataset that has already been cleaned to remove people who did not correctly complete the PT narrative task
no_bots <- wide_data %>% 
  filter(!subid %in% c(96, 99, 166, 167, 171, 239, 265, 345, 613, 758, 778, 779))

no_bots <- no_bots[-c(1), ] 
#Data cleaning
clean_data <- no_bots %>% 
  ## drop two MFQ items that aren't actually the survey - 6, 22 in each
select(-MFQSelf_6, -MFQSelf_22, -MFQTrump_6, -MFQTrump_22, -MFQClin_6,
       -MFQClin_22, -MFQTarg_6, -MFQTarg_22) %>% 
  ## dropping PANAS and exploratory items for this study to make data more manageable
  select(-c(PANAS1_1:PANAS1_20, PANAS2_1:PANAS2_20, 
            gender_writein, race_writein, birth_writein, race_writein, 
            language_writein, raise_writein)) %>% 
  mutate_if(is.factor, as.numeric) %>% 
  ### Wrangling data to get MFQ for self, MFQ to targ, MFQ for stereotype, column for candidate, average of IG identification
  gather("MFQ_Type", "MFQ_Score", MFQSelf_1:MFQTarg_32) %>% 
  separate(.,MFQ_Type, c("MFQ_Type", "MFQ_Number"),"\\_") %>% 
  spread(MFQ_Type, MFQ_Score) %>% 
  gather("IG_Type", "IG_Score", IG_Clin_1:IG_Trump_14) %>% 
  separate(.,IG_Type, c("Drop", "IG_Type", "IG_Number"),"\\_") %>% 
  filter(!is.na(IG_Score)) %>% 
  group_by(subid) %>% 
  #average of in-group identification for each subject
  #making candidate they voted for a factor
  mutate(Cand_votedfor = ifelse(IG_Type == "Clin", 1, 
                                ifelse(IG_Type == "Trump", 0, NA))) %>% 
  gather("Day_key", "Day_content", Day_Clin_In_PT:Day_Trump_In_C) %>% 
  mutate(Day_key = as.factor(Day_key)) %>% 
  filter(!is.na(Day_content)) %>% 
  mutate(inoutgroup = fct_collapse(Day_key, 
                                   Ingroup = c("Day_Clin_In_C", 
                                                "Day_Clin_In_PT", 
                                                "Day_Trump_In_C", 
                                                "Day_Trump_In_PT"), 
                                   Outgroup = c("Day_Clin_Out_C", 
                                                "Day_Clin_Out_PT",
                                                "Day_Trump_Out_C", 
                                                "Day_Trump_Out_PT")),
         PT = fct_collapse(Day_key,
                           PT = c("Day_Clin_In_PT",
                                  "Day_Trump_In_PT",
                                  "Day_Clin_Out_PT",
                                  "Day_Trump_Out_PT"),
                           control = c("Day_Clin_In_C",
                                       "Day_Trump_In_C",
                                       "Day_Clin_Out_C",
                                       "Day_Trump_Out_C")),
         par_cand = fct_collapse(Day_key,
                                  Clinton = c("Day_Clin_In_PT",
                                           "Day_Clin_Out_PT",
                                           "Day_Clin_In_C",
                                           "Day_Clin_Out_C"),
                                  Trump = c("Day_Trump_In_PT",
                                            "Day_Trump_Out_PT",
                                            "Day_Trump_In_C",
                                            "Day_Trump_Out_C")),
         targ_cand = fct_collapse(Day_key,
                                  Clinton = c("Day_Clin_In_PT",
                                              "Day_Clin_In_C",
                                              "Day_Trump_Out_PT",
                                              "Day_Trump_Out_C"),
                                  Trump = c("Day_Clin_Out_PT",
                                            "Day_Clin_Out_C",
                                            "Day_Trump_In_PT",
                                            "Day_Trump_In_C")))

clean_data[,1:31] <- sapply(clean_data[,1:31],as.numeric)
clean_data[,34:36] <- sapply(clean_data[,34:36],as.numeric)

clean_data2 <- clean_data %>%
  mutate(IG_ave = mean(IG_Score)) %>% 
  filter(!is.na(IG_ave)) %>% 
  select(-Drop) %>% 
  #effects coding for group with ingroup = .5 and outgorup = -.5, for PT .5 = PT and Control = -.5
  mutate(inoutgroup_effects = ifelse(inoutgroup == "Ingroup", .5,
                                     ifelse(inoutgroup == "Outgroup", -.5, NA)),
         PT_effects = ifelse(PT == "PT", .5, 
                             ifelse(PT == "control", -.5, NA)),
         targ_cand = ifelse(targ_cand == "Clinton", 1, 
                            ifelse(targ_cand == "Trump", 2, NA)),
         MFQStereo = ifelse(par_cand == "Clinton", MFQClin, 
                            ifelse(par_cand == "Trump", MFQTrump, NA))) %>% 
  #grand mean centering MFQ for self
  mutate(MFQSelf_c = MFQSelf - mean(MFQSelf)) %>%  
  #removing people who failed the manipulation check
  filter(targ_cand == 1 & Man_TargVote == 1 | 
           targ_cand == 2 & Man_TargVote == 2) %>%
  select(-Day_content, -Day_key) %>% 
  #effects coding candidate
  mutate(Targ_Cand_effectscoded = ifelse(targ_cand == "1", .5, 
                                         ifelse(targ_cand == "2", -.5, NA)),
         MFQStereo_c = MFQStereo - mean(MFQStereo, na.rm = TRUE))

#for some reason, this wouldn't work in the piping above, so had to hard code it
#grand mean centering for ingroup identification
clean_data2$ident_c <- clean_data2$IG_ave - mean(clean_data2$IG_ave, na.rm = TRUE)
clean_data2$Gender <- as.factor(clean_data2$Gender)
levels(clean_data2$Gender) <- c("Male", "Female", "Other")
clean_data2$Race <- as.factor(clean_data2$Race)
levels(clean_data2$Race) <- c("American Indian/Native Alaskan", 
                             "Asian", 
                             "Black",
                             "Latinx",
                             "Middle Eastern",
                             "Caucasian",
                             "Multiracial",
                             "Other")

#data with just the variables for analysis for stereotyping
stereo_analysis <- clean_data2 %>% 
  select(subid, MFQ_Number, MFQSelf_c, MFQStereo_c, MFQTarg, ident_c, PT_effects, 
         inoutgroup_effects, Man_PT, par_cand, MFQStereo) %>%
  unique() %>% 
  na.omit()
```

# Downstream outcomes impacted by counter projection - Initial Study

```{r mfq subscales}
#separating MFQ into binding and individualizing subscales
mfq_binding <- clean_data2 %>% 
  filter(MFQ_Number %in% c("3", "4", "5", "9", "10", "11", "14", "15", "16", 
                           "19", "20", "21", "25", "26", "27", "30", "31", "32")) %>%
  select(subid, MFQ_Number, MFQTarg, MFQSelf_c, MFQSelf, MFQStereo_c, MFQStereo, inoutgroup_effects, ident_c, par_cand, Liking, WilltoDiscuss, Valid, Treatment, Contentious) %>% 
  unique() %>% 
  na.omit()

mfq_individual <- clean_data2 %>% 
  filter(MFQ_Number %in% c("1", "2", "7", "8", "12", "13", "17", "18", "23", 
                           "24", "28", "29")) %>%
  select(subid, MFQ_Number, MFQTarg, MFQSelf_c, MFQSelf, MFQStereo_c, MFQStereo, inoutgroup_effects, ident_c, par_cand, Liking, WilltoDiscuss, Valid, Treatment, Contentious) %>% 
  unique() %>% 
  na.omit()
```

```{r downstream outcomes data prep}
downstream_analysis <- clean_data2 %>% 
  select(subid, MFQ_Number, MFQSelf, MFQSelf_c, MFQStereo_c, MFQTarg, ident_c,
         inoutgroup_effects, par_cand, Liking, WilltoDiscuss, Contentious, Treatment, Valid, MFQStereo) %>%
  unique() %>% 
  na.omit() %>% 
  group_by(subid) %>% 
  #getting the difference scores
  #decided to not mean center difference scores, since 0 is meaningful (no difference = 100% projection) 
  mutate(proj_diff = abs(mean(MFQTarg) - mean(MFQSelf)),
         stereo_diff = abs(mean(MFQTarg)- mean(MFQStereo)))

mfq_binding_diff <- mfq_binding %>% 
  group_by(subid) %>% 
  mutate(proj_bind_diff = abs(mean(MFQTarg) - mean(MFQSelf)),
         stereo_bind_diff = abs(mean(MFQTarg) - mean(MFQStereo)))

mfq_individual_diff <- mfq_individual %>% 
 group_by(subid) %>% 
  mutate(proj_indiv_diff = abs(mean(MFQTarg) - mean(MFQStereo)),
         stereo_indiv_diff = abs(mean(MFQTarg) - mean(MFQStereo))) %>% 
  na.omit()
```

## How much do you like the target?

### Overall model

```{r liking output overall}
liking_overall <- lm(Liking ~ proj_diff*stereo_diff*inoutgroup_effects*ident_c, downstream_analysis)
summary(liking_overall)
```

### Overall model Plots

```{r liking overall plots}
#main effect of projection
ggplot(downstream_analysis, aes(proj_diff, Liking)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Liking predicted by projection of moral values",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Liking")
```

Counter projection can be seen as anything with a distance over 1, as that means that people are not listing their score as the same as the targets. The greater the distance demonstrates the greater the counter projection. As can be seen, as people counter project more, they report liking the target less. People who project normally report liking the target the most.

```{r liking overall interaction}
#interaction between projection and degree of identification
describe(downstream_analysis$ident_c)

liking_overall_2way <- effect(term = "proj_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = liking_overall)

liking_overall_2way <- as.data.frame(liking_overall_2way)

liking_overall_2way$Identification <- as.factor(liking_overall_2way$ident_c)

ggplot(liking_overall_2way, aes(proj_diff, fit, group = Identification, color = Identification)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  scale_color_discrete("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak identification \n (1 SD below)", 
                                  "Average identification", 
                                  "High identification \n (1 SD above)")) +
  labs(title = "Liking predicted by projection of moral values",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Liking")
```

Those who weakly identify continue to like the target, even as the distance between their scores on the MFQ and their target's increase (becoming less similar, less projection). As in-group identification increases, self-reported liking of the target decreases as counter projection increases.

### Binding model

```{r liking binding output}
liking_bind <- lm(Liking ~ proj_bind_diff*stereo_bind_diff*inoutgroup_effects*ident_c, mfq_binding_diff)
summary(liking_bind)
```

### Binding model plots

```{r binding liking main effect}
#main effect of projection
ggplot(mfq_binding_diff, aes(proj_bind_diff, Liking)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Liking predicted by projection of binding morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Liking")
```

Same as overall plot.

```{r liking binding interaction group}
liking_bind_2way_group <- effect(term = "proj_bind_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = liking_bind)

liking_bind_2way_group <- as.data.frame(liking_bind_2way_group)

liking_bind_2way_group$group <- as.factor(liking_bind_2way_group$inoutgroup_effects)

ggplot(liking_bind_2way_group, aes(proj_bind_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Liking predicted by projection of binding moral values",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Liking")
```


Liking stays high with the in-group, regardless of their degree of projection. Liking is highest for the out-group when they are projecting. As counter projection increases (the distance becomes further), liking decreases for the out-group.


```{r binding liking 3way}
describe(stereo_analysis$ident_c)

binding_liking_3way <- effect(term = "proj_bind_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = liking_bind)

binding_liking_3way <- as.data.frame(binding_liking_3way)

binding_liking_3way$Group <- as.factor(binding_liking_3way$inoutgroup_effects)
binding_liking_3way$Identification <- as.factor(binding_liking_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(binding_liking_3way, aes(proj_bind_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Liking predicted by projection of binding morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Liking")
```


As can be seen in the plot above, people report liking an in-group target at a similiar rate regardless of projection, while liking of the out-group target decreases as both counter projection and in-group identification increase. Thus, the people who report liking the least are considering an out-group target and are highly identified with their in-group as well as projecting their own morals the least.


### Individuating model

```{r liking individuating model}
liking_indiv <- lm(Liking ~ proj_indiv_diff*stereo_indiv_diff*inoutgroup_effects*ident_c, mfq_individual_diff)
summary(liking_indiv)

linear_check <- lm(Liking ~ proj_indiv_diff*stereo_indiv_diff, mfq_individual_diff)
summary(linear_check)
```


Getting NA's for estimates for stereotyping for individuating morals - a search online says this is because it is linearly dependent on one of the other variables (has reached singularity). After running models checking interactions between each variable and stereo_indiv_diff, it is clear for individuating morals, stereotyping and projection are linearly related (pretty much the same). This is not the case for binding morals or when the morals are combined in the overall model.

Decided not to plot individuating models, as we cannot claim this is due to counter projection, as projection is the same as stereotyping in this case.


## How willing would you be to have a conversation about your political views with this person?

### Overall model output

```{r discuss overall output}
discuss_overall <- lm(WilltoDiscuss ~ proj_diff*stereo_diff*inoutgroup_effects*ident_c, downstream_analysis)
summary(discuss_overall)
```

### Overall plots

```{r will to discuss overall main effect}
#main effect of projection
ggplot(downstream_analysis, aes(proj_diff, WilltoDiscuss)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Willingness to have a coversation with target predicted by projection of morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Willingness")
```


As counter projection increased, willingness to have a conversation with the target decreased.


```{r will to discuss overall interaction group}
discuss_overall_2way_group <- effect(term = "proj_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = discuss_overall)

discuss_overall_2way_group <- as.data.frame(discuss_overall_2way_group)

discuss_overall_2way_group$group <- as.factor(discuss_overall_2way_group$inoutgroup_effects)

ggplot(discuss_overall_2way_group, aes(proj_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Willingness to have conversation with target predicted by projection and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Willingness")
```


Willingness to have a conversation increases for people in the out-group as counter projection increases, while it decreases for the in-group as counter projection occurs. One possible explanation may be that people are willing to have a conversation with their out-group who they see as morally different in order to change them, while people in their in-group who have opposite morals might be more difficult (since they seemingly chose not to have some of the morals the in-group generally seems to share).


```{r discuss 2way identification}
discuss_overall_2way_ident <- effect(term = "proj_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = discuss_overall)

discuss_overall_2way_ident <- as.data.frame(discuss_overall_2way_ident)

discuss_overall_2way_ident$Identification <- as.factor(discuss_overall_2way_ident$ident_c)

ggplot(discuss_overall_2way_ident, aes(proj_diff, fit, group = Identification, color = Identification)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Identification)) +
  theme_minimal() +
  scale_linetype_manual("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak (1 SD below)",
                                  "Average",
                                  "High (1 SD above)"),
                       values = c("solid", 
                                  "dashed",
                                  "dotted")) +
  labs(title = "Willingness to have conversation with target predicted by projection and identification",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Willingness")

```


Willingness to have a conversation starts highest for all levels of identification when they project and this decreases as counter projection increases. However, as can be seen in the plot, the decrease in willingness to discuss as counter projection increases is steepest in higher identifiers, followed by average identifiers.


```{r discuss 3way}
discuss_overall_3way <- effect(term = "proj_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = discuss_overall)

discuss_overall_3way<- as.data.frame(discuss_overall_3way)

discuss_overall_3way$Group <- as.factor(discuss_overall_3way$inoutgroup_effects)
discuss_overall_3way$Identification <- as.factor(discuss_overall_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(discuss_overall_3way, aes(proj_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Willingness to discuss predicted by projection of morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Willingness")
```


Willingness to have a conversation increases the most for out-group targets as counter projection increases and in-group identification increases (weird...). In contrast, willingness to have a conversation with in-group targets decrease as both in-group identification and counter projection increase. 


### Binding model output

```{r discuss bind output}
discuss_bind <- lm(WilltoDiscuss ~ proj_bind_diff*stereo_bind_diff*inoutgroup_effects*ident_c, mfq_binding_diff)
summary(discuss_bind)
```

### Binding plots

```{r will to discuss binding main effect}
#main effect of projection
ggplot(mfq_binding_diff, aes(proj_bind_diff, WilltoDiscuss)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Willingness to have a coversation with target predicted by projection of binding morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Willingness")
```

```{r will to discuss binding interaction group}
discuss_bind_2way_group <- effect(term = "proj_bind_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = discuss_bind)

discuss_bind_2way_group <- as.data.frame(discuss_bind_2way_group)

discuss_bind_2way_group$group <- as.factor(discuss_bind_2way_group$inoutgroup_effects)

ggplot(discuss_bind_2way_group, aes(proj_bind_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Willingness to have conversation with target predicted by projection of binding morals and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Willingness")
```


Doesn't look like much of an interaction... but, I guess, eventually they would overlap as counter projection increases... Either way, people start out less willing to have a conversation with their out-group than their in-group. As counter projection increases, people's willingness to discuss decreases for both in and out-group targets, but more quickly for in-group targets.


```{r discuss binding 2way identification}
discuss_bind_2way_ident <- effect(term = "proj_bind_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = discuss_bind)

discuss_bind_2way_ident <- as.data.frame(discuss_bind_2way_ident)

discuss_bind_2way_ident$Identification <- as.factor(discuss_bind_2way_ident$ident_c)

ggplot(discuss_bind_2way_ident, aes(proj_bind_diff, fit, group = Identification, color = Identification)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Identification)) +
  theme_minimal() +
  scale_linetype_manual("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak (1 SD below)",
                                  "Average",
                                  "High (1 SD above)"),
                       values = c("solid", 
                                  "dashed",
                                  "dotted")) +
  labs(title = "Willingness to have conversation with target predicted by projection of binding morals and identification",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Willingness")
```


Similar to the last model in not being much of an interaction...


```{r discuss binding 3way}
discuss_bind_3way <- effect(term = "proj_bind_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = discuss_bind)

discuss_bind_3way <- as.data.frame(discuss_bind_3way)

discuss_bind_3way$Group <- as.factor(discuss_bind_3way$inoutgroup_effects)
discuss_bind_3way$Identification <- as.factor(discuss_bind_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(discuss_bind_3way, aes(proj_bind_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Willingness to discuss predicted by projection of binding morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Willingness")
```


Now this is more interesting! People who are highly identified with their in-group report the highest willingness to have a conversation with an in-group target, especially when they are projecting. Their decrease in willingness to discuss with their out-group as counter projection increases is the least steep, still resulting in a higher willingness than all other conditions. The lowest willingness to have a conversation occurred with out-group targets when participants' highly identified with their in-group and were counter projecting. Scores for willingness to discuss for in and out-group targets were the closet to one another when participants were weakly identified with their in-group and were counter projecting.


### Individuating model output

```{r discuss indiv output}
discuss_indiv <- lm(WilltoDiscuss ~ proj_indiv_diff*stereo_indiv_diff*ident_c, mfq_individual_diff)
summary(discuss_indiv)
```

## How contentious do you think a conversation about your political views would be with this person?

### Overall model

```{r contentious overall output}
content_overall <- lm(Contentious ~ proj_diff*stereo_diff*inoutgroup_effects*ident_c, downstream_analysis)
summary(content_overall)
```

### Overall plots

```{r content overall main effect}
#main effect of projection
ggplot(downstream_analysis, aes(proj_diff, Contentious)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Contentiousness predicted by projection of morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Contentousness")
```


As counter projection increases, predicted contentiousness with the target while have a conversation increases.


```{r content overall interaction group}
content_overall_2way_group <- effect(term = "proj_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = content_overall)

content_overall_2way_group <- as.data.frame(content_overall_2way_group)

content_overall_2way_group$group <- as.factor(content_overall_2way_group$inoutgroup_effects)

ggplot(content_overall_2way_group, aes(proj_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Contentiousness with target predicted by projection and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Contentiousness")
```


Predicted contentiousness with a target starts higher for those considering an out-group target instead of an in-group target and increases gradually as counter projection increases. However, predicted contentiousness increases more quickly as counter projection increases for those considering an in-group target.


```{r content 2way identification}
content_overall_2way_ident <- effect(term = "proj_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = content_overall)

content_overall_2way_ident <- as.data.frame(content_overall_2way_ident)

content_overall_2way_ident$Identification <- as.factor(content_overall_2way_ident$ident_c)

ggplot(content_overall_2way_ident, aes(proj_diff, fit, group = Identification, color = Identification)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Identification)) +
  theme_minimal() +
  scale_linetype_manual("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak (1 SD below)",
                                  "Average",
                                  "High (1 SD above)"),
                       values = c("solid", 
                                  "dashed",
                                  "dotted")) +
  labs(title = "Contentiousness predicted by projection and identification",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Contentiousness")
```


Predicted contentiousness starts higher for those who are highly identified with their in-group and increases the most as counter projection increases. On the other hand, contentiousness starts the lowest for those who are weakly identified with their in-group and increases the least as counter projection increases.


```{r content 3way}
content_overall_3way <- effect(term = "proj_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = content_overall)

content_overall_3way <- as.data.frame(content_overall_3way)

content_overall_3way$Group <- as.factor(content_overall_3way$inoutgroup_effects)
content_overall_3way$Identification <- as.factor(content_overall_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(content_overall_3way, aes(proj_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Contentiousness predicted by projection of morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Contentiousness")
```


For those considering an out-group target, their predicted contentiousness starts higher than those considering an out-group target. As in-group identification increases, counter projection as less of an impact on predicted contentiousness with those considering out-group targets. Specifically, when weakly identified, as counter projection increases, predicted contentiousness also increases. However, when highly identified, predicted contentiousness stays the same as counter projection increases. 

For those considering an in-group target, predicted contentiousness increases as counter projection increases, but more so for those who are highly identified with their in-group, followed by average identifiers, with low identifiers only showing a slight increase as counter projection increases. Interestingly, for those who are highly identified, when counter projection is high, people report higher contentiousness with the in-group target than they would with their out-group target. 


### Binding model

```{r contentious bind output}
content_bind <- lm(Contentious ~ proj_bind_diff*stereo_bind_diff*ident_c*inoutgroup_effects, mfq_binding_diff)
summary(content_bind)
```

### Binding plots

```{r content bind main effect}
ggplot(mfq_binding_diff, aes(proj_bind_diff, Contentious)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Contentiousness predicted by projection of binding morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Contentousness")
```


As counter projection increases, predicted contentiousness with the target while have a conversation increases.


```{r content bind interaction group}
content_bind_2way_group <- effect(term = "proj_bind_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = content_bind)

content_bind_2way_group <- as.data.frame(content_bind_2way_group)

content_bind_2way_group$group <- as.factor(content_bind_2way_group$inoutgroup_effects)

ggplot(content_bind_2way_group, aes(proj_bind_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Contentiousness with target predicted by projection of binding morals and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Contentiousness")
```


Predicted contentiousness was higher for out-group targets than in-group targets and, as counter projection of binding morals increases, contentiousness increases more for out-group targets as well. 


### Individuating model

```{r contentious indiv output}
content_indiv <- lm(Contentious  ~ proj_indiv_diff*stereo_indiv_diff*ident_c*inoutgroup_effects, mfq_individual_diff)
summary(content_indiv)
```

## How well you think the target would treat you during this conversation?

### Overall model

```{r treat output overall}
treat_overall <- lm(Treatment ~ proj_diff*stereo_diff*inoutgroup_effects*ident_c, downstream_analysis)
summary(treat_overall)
```


No main effect for treatment - the only outcome in which this occurs.


### Overall plots

```{r treat overall interaction group}
treat_overall_2way_group <- effect(term = "proj_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = treat_overall)

treat_overall_2way_group <- as.data.frame(treat_overall_2way_group)

treat_overall_2way_group$group <- as.factor(treat_overall_2way_group$inoutgroup_effects)

ggplot(treat_overall_2way_group, aes(proj_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Treatment by target predicted by projection and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Treatment")
```


Participants expected the target to treat them better in the in-group than the out-group. As counter projection increased, expected treatment decreased for the out-group, while only barely decreasing for the in-group.


```{r treat 2way identification}
treat_overall_2way_ident <- effect(term = "proj_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = treat_overall)

treat_overall_2way_ident <- as.data.frame(treat_overall_2way_ident)

treat_overall_2way_ident$Identification <- as.factor(treat_overall_2way_ident$ident_c)

ggplot(treat_overall_2way_ident, aes(proj_diff, fit, group = Identification, color = Identification)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Identification)) +
  theme_minimal() +
  scale_linetype_manual("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak (1 SD below)",
                                  "Average",
                                  "High (1 SD above)"),
                       values = c("solid", 
                                  "dashed",
                                  "dotted")) +
  labs(title = "Treatment by target predicted by projection and identification",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Treatment")

```


For people who weakly identify with their in-group, as counter projection increases, expected treatment slightly increases. However, for people who identify with their in-group an average amount or highly, as counter projection increases, expected treatment decreases, with it decreasing the most for people who highly identified with their in-group.


### Binding model

```{r treat output bind}
treat_bind <- lm(Treatment ~ proj_bind_diff*stereo_bind_diff*inoutgroup_effects*ident_c, mfq_binding_diff)
summary(treat_bind)
```

### Binding plots

```{r treat bind 3way}
treat_bind_3way <- effect(term = "proj_bind_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = treat_bind)

treat_bind_3way <- as.data.frame(treat_bind_3way)

treat_bind_3way$Group <- as.factor(treat_bind_3way$inoutgroup_effects)
treat_bind_3way$Identification <- as.factor(treat_bind_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(treat_bind_3way, aes(proj_bind_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Treatment by target predicted by projection of binding morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Treatment")
```


All treatment scores for the in-group condition were higher than those in the out-group. People in the low identification condition expected their in-group to treat them better than their out-group; However, as counter projection increased, expected treatment decreased for those in the in-group condition, while remaining the same for those in the out-group condition. For those who reported average in-group identification, as counter projection increased, people in the out-group condition reported worse treatment scores, while those in the in-group did not report a change. For those who reported high in-group identification, as count projection increased, people expected their out-group to treat them worse, while people expected their in-group to treat them better.


### Individuating model

```{r treat output indiv}
treat_indiv <- lm(Treatment  ~ proj_indiv_diff*stereo_indiv_diff*inoutgroup_effects*ident_c, mfq_individual_diff)
summary(treat_indiv)
```

## How valid do you think the target's political position is?

### Overall model

```{r valid output overall}
valid_overall <- lm(Valid ~ proj_diff*stereo_diff*inoutgroup_effects*ident_c, downstream_analysis)
summary(valid_overall)
```

### Overall plots

```{r valid overall main effect}
ggplot(downstream_analysis, aes(proj_diff, Valid)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Validity of target's position predicted by projection of morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Validity")
```


As counter projection increases, validity of the target's position decreases.


```{r valid overall interaction group}
valid_overall_2way_group <- effect(term = "proj_diff:inoutgroup_effects", 
                           xlevels = list(inoutgroup_effects = c(-.5,.5)), 
                           mod = valid_overall)

valid_overall_2way_group <- as.data.frame(valid_overall_2way_group)

valid_overall_2way_group$group <- as.factor(valid_overall_2way_group$inoutgroup_effects)

ggplot(valid_overall_2way_group, aes(proj_diff, fit, group = group, color = group)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = group)) +
  theme_minimal() +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  labs(title = "Validity of target's position predicted by projection and target group",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Validity")
```


People report higher validity of target's position in the in-group condition than out-group condition and, as counter projection increases, validity decreases more in the out-group condition than the in-group condition.


```{r valid 2way identification}
valid_overall_2way_ident <- effect(term = "proj_diff:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78)), 
                           mod = valid_overall)

valid_overall_2way_ident <- as.data.frame(valid_overall_2way_ident)

valid_overall_2way_ident$Identification <- as.factor(valid_overall_2way_ident$ident_c)

ggplot(valid_overall_2way_ident, aes(proj_diff, fit, group = Identification, color = Identification)) +
 geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Identification)) +
  theme_minimal() +
  scale_linetype_manual("Identification", breaks = c(-1.78, 0, 1.78), 
                       labels = c("Weak (1 SD below)",
                                  "Average",
                                  "High (1 SD above)"),
                       values = c("solid", 
                                  "dashed",
                                  "dotted")) +
  labs(title = "Validity of target's position predicted by projection and identification",
       subtitle = "Projection is the absolute value of the difference score between average \nMFQ scores for target and self. Higher scores = greater counter projection.",
       x = "Projection (Higher = more counter projection)",
       y = "Validity")
```


As counter projection increases, those who report highly identifying with their in-group report the largest decrease in validity of the target's opinion, followed by those who identify with their in-group an average amount. Those who weakly identify with their in-group actually show a slight increase in reported validity as counter projection increases.


```{r valid 3way}
valid_overall_3way <- effect(term = "proj_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = valid_overall)

valid_overall_3way <- as.data.frame(valid_overall_3way)

valid_overall_3way$Group <- as.factor(valid_overall_3way$inoutgroup_effects)
valid_overall_3way$Identification <- as.factor(valid_overall_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")

ggplot(valid_overall_3way, aes(proj_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Validity of target's position predicted by projection of morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Validity")
```


For those in the in-group position, regardless of in-group identification, as counter projection increases, reported validity decreases only slightly. However, low in-group identifiers overall reported lower validity of their in-group's opinion that high identifiers. For those in the out-group condition, as counter projection increased, low in-group identifiers report target validity increasing. However, both average and high in-group identifiers report decreases in target validity as counter projection increases, with high in-group identifiers exhibiting the largest decrease.


### Binding model

```{r valid output bind}
valid_bind <- lm(Valid~ proj_bind_diff*stereo_bind_diff*inoutgroup_effects*ident_c, mfq_binding_diff)
summary(valid_bind)
```

### Binding plots

```{r valid bind main effect}
#main effect of projection
ggplot(mfq_binding_diff, aes(proj_bind_diff, Valid)) +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(title = "Validity of target's position predicted by projection of binding morals",
       subtitle = "Projection is the absolute value of the difference score \nbetween average MFQ binding scores for target and self",
       x = "Projection (Higher numbers indicate lower projection)",
       y = "Validity")
```


As counter projection of binding morals increases, validity decreases.


```{r valid bind 3way}
valid_bind_3way <- effect(term = "proj_bind_diff:inoutgroup_effects:ident_c", 
                           xlevels = list(ident_c = c(-1.78, 0, 1.78), 
                                         inoutgroup_effects = c(-.5,.5)), 
                           mod = valid_bind)

valid_bind_3way <- as.data.frame(valid_bind_3way)

valid_bind_3way$Group <- as.factor(valid_bind_3way$inoutgroup_effects)
valid_bind_3way$Identification <- as.factor(valid_bind_3way$ident_c)

ident_label <- c("-1.78" = "Low identification \n (1 SD below)", 
                 "0" = "Average identification",
                 "1.78" = "High identificatiion \n(1 SD above)")


#three-way interaction
ggplot(valid_bind_3way, aes(proj_bind_diff,
                             fit, 
                             group = Group,
                             color = Group)) +
  geom_smooth(method = "lm", se = FALSE, size = .7, colour = "black", 
              aes(linetype = Group)) +
  facet_wrap(~Identification, labeller = 
               labeller(Identification = ident_label)) +
  scale_linetype_manual("Group", breaks = c(-.5, .5), 
                       labels = c("Out-group", "In-group"),
                       values = c("solid", 
                                   "dashed")) +
  theme_minimal() +
  labs(title = "Validity of target's position predicted by projection of binding morals, \nin-group identification and group membership",
       subtitle = "Controlling for stereotyping",
       x = "Projection difference scores (higher = more counter projection)",
       y = "Validity")
```


For those who weakly identify with their in-group, people report higher validity for their in-group than their out-group, but, as counter projection increases, validity for both groups decreases by a similar amount. For people who report average identification with their in-group, they report higher validity for their in-group than their out-group and, as counter projection increases, validity for the in-group does not change, while validity for the out-group decreases. For those who highly identify with their in-group, people report higher validity for their in-group than their out-group and, as counter projection increases, validity for the in-group increases, while validity to the out-group decreases to the lowest reported validity of all conditions.


### Individuating model

```{r valid output indiv}
valid_indiv <- lm(Valid  ~ proj_indiv_diff*stereo_indiv_diff*inoutgroup_effects*ident_c, mfq_individual_diff)
summary(valid_indiv)
```


# Look at downstream effects with coefficients from lmer model per person

```{r data set-up for coeff downstream analysis,include = FALSE}
#getting the coefficients from initial study with stereotyping
projmodel_stereo <- lmer(MFQTarg ~ MFQSelf_c * MFQStereo_c *
                                    inoutgroup_effects * ident_c +
                                    (MFQSelf_c|subid), 
                                 data = stereo_analysis)

coefficents <- coef(projmodel_stereo)$subid

subid <- rownames(coefficents)

coefficients <- cbind(id = subid, coefficents)

coefficients <- coefficients %>% mutate(subid = as.numeric(id))

#getting data we need to predict to combine
tomerge <- downstream_analysis %>% 
  select(subid, Liking, WilltoDiscuss, Contentious, Treatment, Valid)

downstream_coeffs <- left_join(coefficients, tomerge) %>% select(-id) %>% unique()
  
```

## Liking

### Overall

```{r liking coeff}
liking_coeff <- lm(Liking ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs)

summary(liking_coeff)

ggplot(downstream_coeffs,aes(MFQSelf_c, Liking)) +
  geom_smooth(method = "lm") +
  labs(title = "Liking predicted by projection coefficient",
       subtitle = "Coefficient from initial study model controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

### Liking including similiarity difference scores

```{r liking coeff with diff scores}
diffs <- downstream_analysis %>% 
  select(subid, proj_diff, stereo_diff)

coeffs_and_diffs <- left_join(downstream_coeffs, diffs) %>%  unique()

liking_codiff <- lm(Liking ~ MFQSelf_c*proj_diff, coeffs_and_diffs)
summary(liking_codiff)
```

Two main effects but no interaction for liking. By the negative coefficient for the similarity score, we can tell that as dissimilarity increases, liking decreases (like the plot we did for the downstream effects using difference scores before).

### Liking with binding model coefficients

```{r data set-up for coeff downstream analysis for binding, inclue = FALSE}
#getting the coefficients from initial study with stereotyping
is_mfqbinding <- lmer(MFQTarg ~ MFQSelf_c * MFQStereo_c *
                                    inoutgroup_effects * ident_c +
                                    (MFQSelf_c|subid), 
                                 data = mfq_binding)

coeffs_bind <- coef(is_mfqbinding)$subid

subid <- rownames(coeffs_bind)

coeffs_bind <- cbind(id = subid, coeffs_bind)

coeffs_bind <- coeffs_bind %>% mutate(subid = as.numeric(id))

downstream_coeffs_bind <- left_join(coeffs_bind, tomerge) %>% select(-id) %>% unique()
```

```{r liking coeff binding}
liking_coeff_bind <- lm(Liking ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_bind)
summary(liking_coeff_bind)

ggplot(downstream_coeffs_bind,aes(MFQSelf_c, Liking)) +
  geom_smooth(method = "lm") +
  labs(title = "Liking predicted by projection coefficient",
       subtitle = "Coefficient from initial study with binding data only controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

This looks pretty much the same as the overall model

### Liking with individuating model coefficients

```{r data set-up for coeff downstream analysis for indiv, include = FALSE}
#getting the coefficients from initial study with stereotyping
is_mfqindividual <- lmer(MFQTarg ~ MFQSelf_c * MFQStereo_c *
                                    inoutgroup_effects * ident_c +
                                    (MFQSelf_c|subid), 
                                 data = mfq_individual)

coeffs_indiv <- coef(is_mfqindividual)$subid

subid <- rownames(coeffs_indiv)

coeffs_indiv <- cbind(id = subid, coeffs_indiv)

coeffs_indiv <- coeffs_indiv %>% mutate(subid = as.numeric(id))

downstream_coeffs_indiv <- left_join(coeffs_indiv, tomerge) %>% select(-id) %>% unique() %>%  na.omit()
```

```{r liking coeff indiv}
liking_coeff_indiv <- lm(Liking ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_indiv)
summary(liking_coeff_indiv)

ggplot(downstream_coeffs_indiv,aes(MFQSelf_c, Liking)) +
  geom_smooth(method = "lm") +
  labs(title = "Liking predicted by projection coefficient",
       subtitle = "Coefficient from initial study with individuating data only controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

Also pretty much the same as the overall model

## Willingness to have discussion

```{r willtodiscuss coeffs}
discuss_coeffs <- lm(WilltoDiscuss ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs)
summary(discuss_coeffs)

ggplot(downstream_coeffs,aes(MFQSelf_c, WilltoDiscuss)) +
  geom_smooth(method = "lm") +
  labs(title = "Willigness to have a conversation predicted by projection coefficient",
       subtitle = "Coefficient from initial study controlling for stereotyping",
       x = "Projection coefficient",
       y = "Willingness") +
  theme_minimal()
```

### Willingness with difference scores too

```{r willtodiscuss coeff with diff scores}
discuss_codiff <- lm(WilltoDiscuss ~ MFQSelf_c*proj_diff, coeffs_and_diffs)
summary(discuss_codiff)
```

Still significant after including the similarity scores, which, again, are also significant but the interaction between the two is not.

### Willingness with binding data

```{r discuss coeff binding}
discuss_coeff_bind <- lm(WilltoDiscuss ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_bind)
summary(discuss_coeff_bind)

ggplot(downstream_coeffs_bind,aes(MFQSelf_c, WilltoDiscuss)) +
  geom_smooth(method = "lm") +
  labs(title = "Willingness to have discussion predicted by projection coefficient",
       subtitle = "Coefficient from initial study with binding data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Willingness") +
  theme_minimal()
```

### Willingness with individuating data

```{r discuss coeff indiv}
discuss_coeff_indiv <- lm(WilltoDiscuss ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_indiv)
summary(discuss_coeff_indiv)

ggplot(downstream_coeffs_indiv,aes(MFQSelf_c, WilltoDiscuss)) +
  geom_smooth(method = "lm") +
  labs(title = "Willingness to have discussion predicted by projection coefficient",
       subtitle = "Coefficient from initial study with individuating data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Willingness") +
  theme_minimal()
```

The effect was there with the binding data, but is only marginal with the individuating data.

## Contentiousness predicted by coefficients

```{r contentiousness coeffs}
content_coeffs <- lm(Contentious ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs)
summary(content_coeffs)

ggplot(downstream_coeffs,aes(MFQSelf_c, Contentious)) +
  geom_smooth(method = "lm") +
  labs(title = "Contentiousness predicted by projection coefficient",
       subtitle = "Coefficient from initial study controlling for stereotyping",
       x = "Projection coefficient",
       y = "Contentiousness") +
  theme_minimal()
```

### Contentiousness with difference scores too

```{r content coeff with diff scores}
content_codiff <- lm(Contentious ~ MFQSelf_c*proj_diff, coeffs_and_diffs)
summary(content_codiff)
```

Projection is significant, but the difference score is only marginal.

### Contentiousness with binding data

```{r content coeff binding}
content_coeff_bind <- lm(Contentious ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_bind)
summary(content_coeff_bind)

ggplot(downstream_coeffs_bind,aes(MFQSelf_c, Contentious)) +
  geom_smooth(method = "lm") +
  labs(title = "Contentiousness predicted by projection coefficient",
       subtitle = "Coefficient from initial study with binding data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Contentiousness") +
  theme_minimal()
```

### Contentiousness with individuating data

```{r content coeff indiv}
content_coeff_indiv <- lm(Contentious ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_indiv)
summary(content_coeff_indiv)

ggplot(downstream_coeffs_indiv,aes(MFQSelf_c, Contentious)) +
  geom_smooth(method = "lm") +
  labs(title = "Contentiousness predicted by projection coefficient",
       subtitle = "Coefficient from initial study with individuating data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Contentiousness") +
  theme_minimal()
```

The models for individuating and binding data don't differ much from the overall model.

## Treatment predicted by coefficients

```{r treatment coeffs}
treat_coeffs <- lm(Treatment ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs)
summary(treat_coeffs)

ggplot(downstream_coeffs,aes(MFQSelf_c, Treatment)) +
  geom_smooth(method = "lm") +
  labs(title = "Treatment predicted by projection coefficient",
       subtitle = "Coefficient from initial study controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

### Treatment with difference scores too

```{r treat coeff with diff scores}
treat_codiff <- lm(Treatment ~ MFQSelf_c*proj_diff, coeffs_and_diffs)
summary(treat_codiff)
```

Both have main effects but the interaction is not significant.

### Treatment with binding data

```{r treat coeff binding}
treat_coeff_bind <- lm(Treatment ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_bind)
summary(treat_coeff_bind)

ggplot(downstream_coeffs_bind,aes(MFQSelf_c, Treatment)) +
  geom_smooth(method = "lm") +
  labs(title = "Treatment predicted by projection coefficient",
       subtitle = "Coefficient from initial study with binding data only controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

### Treatment with individuating data

```{r treat coeff indiv}
treat_coeff_indiv <- lm(Treatment ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_indiv)
summary(treat_coeff_indiv)

ggplot(downstream_coeffs_indiv,aes(MFQSelf_c, Treatment)) +
  geom_smooth(method = "lm") +
  labs(title = "Treatment predicted by projection coefficient",
       subtitle = "Coefficient from initial study with individuating data only controlling for stereotyping",
       x = "Projection coefficient") +
  theme_minimal()
```

Treatment effects with individuating and binding data look pretty much the same as the overall model.

## Validity predicted by coefficients

```{r valid coeffs}
valid_coeffs <- lm(Valid ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs)
summary(valid_coeffs)

ggplot(downstream_coeffs,aes(MFQSelf_c, Valid)) +
  geom_smooth(method = "lm") +
  labs(title = "Validity of target's position predicted by projection coefficient",
       subtitle = "Coefficient from initial study controlling for stereotyping",
       x = "Projection coefficient",
       y = "Validity") +
  theme_minimal()
```

### Validity with difference scores too

```{r valid coeff with diff scores}
valid_codiff <- lm(Valid ~ MFQSelf_c*proj_diff, coeffs_and_diffs)
summary(valid_codiff)
```

Both have main effects but the interaction is not significant.

### Validity with binding data

```{r valid coeff binding}
valid_coeff_bind <- lm(Valid ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_bind)
summary(valid_coeff_bind)

ggplot(downstream_coeffs_bind,aes(MFQSelf_c, Valid)) +
  geom_smooth(method = "lm") +
  labs(title = "Validity predicted by projection coefficient",
       subtitle = "Coefficient from initial study with binding data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Validity") +
  theme_minimal()
```

### Validity with individuating data

```{r valid coeff indiv}
valid_coeff_indiv <- lm(Valid ~ MFQSelf_c*`MFQSelf_c:inoutgroup_effects`*`MFQSelf_c:ident_c`*`MFQSelf_c:inoutgroup_effects:ident_c`, data = downstream_coeffs_indiv)
summary(valid_coeff_indiv)

ggplot(downstream_coeffs_indiv,aes(MFQSelf_c, Valid)) +
  geom_smooth(method = "lm") +
  labs(title = "Validity predicted by projection coefficient",
       subtitle = "Coefficient from initial study with individuating data only controlling for stereotyping",
       x = "Projection coefficient",
       y = "Validity") +
  theme_minimal()
```

Models using the individuating and binding data look the same as the overall model.
